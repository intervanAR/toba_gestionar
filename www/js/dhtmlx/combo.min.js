function d5XCombo(t,e,s,i,o){var n=this,l=null,h=null;"object"!=typeof t||t.tagName||(t=(l=t).parent,s=l.width,e=l.name,i=l.mode,h=l.skin),this.cont="string"==typeof t?document.getElementById(t):t,this.conf={skin:null,form_name:e||"dhxcombo",combo_width:(parseInt(s)||this.cont.offsetWidth||120)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0),combo_image:!1,combo_focus:!1,opts_type:"string"==typeof i&&void 0!==this.modes[i]?i:"option",opts_count:8,opts_count_min:3,opts_width:null,item_h:null,list_zi_id:window.dhx4.newId(),allow_free_text:!0,allow_empty_value:!0,free_text_empty:!1,enabled:!0,btn_left:(window.dhx4.isIE6||window.dhx4.isIE7||window.dhx4.isIE8)&&void 0===window.addEventListener?1:0,ro_mode:!1,ro_text:"",ro_tm:null,ro_tm_time:750,img_path:"",img_def:"",img_def_dis:!0,template:{header:!0,input:"#text#",option:"#text#"},f_func:null,f_mode:!1,f_url:!1,f_cache:!1,f_cache_data:{},f_dyn:!1,f_dyn_end:!1,f_mask:"",f_ac:!0,f_ac_text:"",f_server_tm:null,f_server_last:"",f_loading:!1,s_tm:null,s_time:200,s_mode:"select",last_hover:null,last_selected:null,last_match:null,last_text:"",last_value:"",tm_hover:null,tm_confirm_blur:null,clear_click:!1,clear_blur:!1,clear_bsp:!1,clear_key:!1,i_ofs:23,sp:{dhx_skyblue:{list_ofs:1,hdr_ofs:1,scr_ofs:1},dhx_web:{list_ofs:0,hdr_ofs:1,scr_ofs:0},dhx_terrace:{list_ofs:1,hdr_ofs:1,scr_ofs:1},material:{list_ofs:0,hdr_ofs:1,scr_ofs:1}},col_w:null},this.conf.combo_image=1==this.modes[this.conf.opts_type].image,this.t={},this.base=document.createElement("DIV"),this.base.style.width=this.conf.combo_width+"px",this.base.innerHTML="<input type='text' class='dhxcombo_input' style='width:"+(this.conf.combo_width-(this.conf.i_ofs+1)-(this.conf.combo_image?this.conf.i_ofs:0))+"px;"+(this.conf.combo_image?"margin-left:"+this.conf.i_ofs+"px;":"")+"' autocomplete='off'><input type='hidden' value=''><input type='hidden' value='false'><div class='dhxcombo_select_button'><div class='dhxcombo_select_img'></div></div>"+(this.conf.combo_image?"<div class='dhxcombo_top_image'>"+this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled)+"</div>":""),this.cont.appendChild(this.base),this.list=document.createElement("DIV"),this.list._listId=window.dhx4.newId(),this.list.style.display="none",document.body.insertBefore(this.list,document.body.firstChild),this._doOnListScroll=function(){null!=n.conf.s_tm&&window.clearTimeout(n.conf.s_tm),n.conf.s_tm=window.setTimeout(n._doOnListScrollAction,n.conf.s_time)},this._doOnListScrollAction=function(){n.conf.s_tm=null,"scroll"==n.conf.s_mode&&n.list.scrollHeight-n.list.scrollTop-10<n.list.clientHeight&&n._subloadRequest()},"function"==typeof window.addEventListener?this.list.addEventListener("scroll",this._doOnListScroll,!1):this.list.attachEvent("onscroll",this._doOnListScroll),this.setSkin(h||window.dhx4.skin||("undefined"!=typeof d5x?d5x.skin:null)||window.dhx4.skinDetect("dhxcombo")||"material"),this._updateTopImage=function(t){this.conf.combo_image&&(this.base.lastChild.innerHTML=null!=t?this.t[t].obj.getTopImage(this.t[t].item,this.conf.enabled):this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled))},this._filterOpts=function(t){this.conf.f_server_tm&&window.clearTimeout(this.conf.f_server_tm);var e=String(this.base.firstChild.value).replace(new RegExp(this._fixRE(this.conf.f_ac_text)+"$","i"),"");if(this.conf.f_server_last!=e.toLowerCase()){if(null!=this.conf.f_url&&this.checkEvent("onDynXLS"))return this.conf.f_server_last=e.toLowerCase(),void this.callEvent("onDynXLS",[e]);if(null!=this.conf.f_url){if(0==e.length)return this.conf.f_server_last=e.toLowerCase(),void this.clearAll();if(1==this.conf.f_cache&&null!=this.conf.f_cache_data[e]){this.clearAll(),this.conf.f_server_last=e.toLowerCase();for(var s=0;s<this.conf.f_cache_data[e].data.length;s++)this.load(this.conf.f_cache_data[e].data[s]);this.conf.f_dyn&&(this.conf.f_dyn_end=this.conf.f_cache_data[e].dyn_end,this.conf.f_mask=this.conf.f_cache_data[e].mask),!0!==t&&(this._showList(!0),this._checkForMatch())}else this.conf.f_server_tm=window.setTimeout(function(){n.conf.f_server_last=e.toLowerCase(),n.conf.f_mask=e;var s="mask="+encodeURIComponent(e);n.conf.f_dyn&&(s+="&pos=0",n.conf.f_dyn_end=!1);var i=function(s){if(n.conf.f_cache&&(n.conf.f_cache_data[e]||(n.conf.f_cache_data[e]={data:[],dyn_end:!1,mask:e}),n.conf.f_cache_data[e].data.push(s.xmlDoc.responseXML)),n.clearAll(),n.load(s.xmlDoc.responseText),1==(n.base.offsetWidth>0&&n.base.offsetHeight>0)&&1==n.conf.enabled&&1==n.conf.combo_focus&&!0!==t){if(n.conf.f_ac&&"start"==n.conf.f_mode&&0==n.conf.clear_bsp&&null!=n.list.firstChild){var o=n.list.firstChild._optId,l=String(n.t[o].obj.getText(n.list.firstChild,!0));e==n.base.firstChild.value&&0===String(l).toLowerCase().indexOf(String(e).toLowerCase())&&(n.base.firstChild.value=l,n.conf.f_ac_text=l.substr(e.length),n._selectRange(e.length,l.length))}n._showList(!0),n._checkForMatch()}i=null};"post"==window.dhx4.ajax.method?window.dhx4.ajax.post(n.conf.f_url,s,i):"get"==window.dhx4.ajax.method&&window.dhx4.ajax.get(n.conf.f_url+(String(n.conf.f_url).indexOf("?")>=0?"&":"?")+s,i)},200)}else{this.conf.f_server_last=e.toLowerCase();var i=0==e.length||new RegExp(("start"==this.conf.f_mode?"^":"")+this._fixRE(e),"i"),o=null;for(var l in this.t){var h=!1;if(!0!==i)if(null!=this.conf.f_func){var c=this._getOption(this.t[l].item._optId,s);h=1==this.conf.f_func.apply(window,[e,c])}else{var d=this.t[l].obj.getText(this.t[l].item,!0);h=1==i.test(d)}!0===i||1==h?(this.t[l].item.style.display="",null==o&&e.length>0&&(o=String(this.t[l].obj.getText(this.t[l].item,!0)))):this.t[l].item.style.display="none"}this.conf.f_ac&&"start"==this.conf.f_mode&&0==this.conf.clear_bsp&&null!=o&&(this.conf.f_ac_text=o.replace(new RegExp("^"+e,"i"),""),this.base.firstChild.value=o,this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)),"between"==this.conf.f_mode&&1==this.conf.clear_bsp&&this._checkForMatch(!0),!0!==t&&(this._showList(!0),this._checkForMatch())}}else this._checkForMatch()},this._searchRO=function(t){this.conf.ro_tm&&window.clearTimeout(this.conf.ro_tm),this.conf.ro_text+=t,this._showList();for(var e=0;e<this.list.childNodes.length;e++){var s=this.list.childNodes[e]._optId;if(0===String(this.t[s].obj.getText(this.list.childNodes[e],!0)).toLowerCase().indexOf(this.conf.ro_text)){this._setSelected(s,!0,!0),this._confirmSelect("script",!1);break}}this.conf.ro_tm=window.setTimeout(function(){n.conf.ro_text=""},this.conf.ro_tm_time)},this._fixRE=function(t){return String(t).replace(/[\\\^\$\*\+\?\.\(\)\|\{\}\[\]]/gi,"\\$&")},this._initObj=function(t){void 0!==t.template&&this.setTemplate(t.template),1!=t.add&&1!=this.conf.f_loading&&this.clearAll(!1),this.addOption(t.options)},this._xmlToObj=function(t,e,s){var i={add:!1,options:[]},o=1==e?t:t.getElementsByTagName("complete");if(o.length>0){1==window.dhx4.s2b(o[0].getAttribute("add"))&&(i.add=!0);for(var n=o[0].childNodes,l=0;l<n.length;l++)if(void 0!==n[l].tagName){if("template"==String(n[l].tagName).toLowerCase()){for(var h={},c=0;c<n[l].childNodes.length;c++){if(null!=(b=n[l].childNodes[c]).tagName){var d=b.tagName;if(void 0!==this.conf.template[d]&&(h[d]=window.dhx4._xmlNodeValue(b)),"columns"==d)for(var a=0;a<b.childNodes.length;a++){var r=b.childNodes[a];if(null!=r.tagName&&"column"==r.tagName){var f={};for(var _ in{width:1,css:1,header:1,option:1})null!=r.getAttribute(_)&&(f[_]=r.getAttribute(_));for(var _ in{header:1,option:1}){var u=r.getElementsByTagName(_);null!=u[0]&&null!=u[0].firstChild&&(f[_]=window.dhx4._xmlNodeValue(u[0]))}null==h.columns&&(h.columns=[]),h.columns.push(f)}r=null}}b=null}this.setTemplate(h)}if("option"==String(n[l].tagName).toLowerCase()){var m=!1;m=1==e?i.options.length==s:window.dhx4.s2b(n[l].getAttribute("selected"));var p={value:n[l].getAttribute("value"),text:window.dhx4._xmlNodeValue(n[l]),selected:m,checked:window.dhx4.s2b(n[l].getAttribute("checked"))};for(var _ in{img:1,img_dis:1,img_src:1,img_src_dis:1,css:1})null!=n[l].getAttribute(_)&&(p[_]=n[l].getAttribute(_));for(c=0;c<n[l].childNodes.length;c++)if(null!=n[l].childNodes[c].tagName&&"text"==String(n[l].childNodes[c].tagName).toLowerCase()){p.text={};var b=n[l].childNodes[c];for(a=0;a<b.childNodes.length;a++)null!=b.childNodes[a].tagName&&(p.text[b.childNodes[a].tagName]=window.dhx4._xmlNodeValue(b.childNodes[a]))}i.options.push(p)}}o=n=null}return i},window.dhx4._enableDataLoading(this,"_initObj","_xmlToObj","complete",{data:!0}),window.dhx4._eventable(this),this._getNearItem=function(t,e){for(var s=null;null!=t;)t=t[e<0?"previousSibling":"nextSibling"],null==s&&null!=t&&""==t.style.display&&null!=t._optId&&(s=t,t=null);return s},this.setName(this.conf.form_name),this._doOnListMouseMove=function(t){for(var e=(t=t||event).target||t.srcElement;null!=e&&e!=this;)void 0!==e._optId&&(n.conf.tm_hover&&window.clearTimeout(n.conf.tm_hover),n._setSelected(e._optId,!1,!1,!0)),e=e.parentNode;e=null},this._doOnListMouseDown=function(t){(t=t||event).cancelBubble=!0,n.conf.clear_click=!0,window.setTimeout(function(){n.base.firstChild.focus()},1)},this._doOnListMouseUp=function(t){if((t=t||event).button==n.conf.btn_left){for(var e=t.target||t.srcElement;null!=e&&e!=this;){if(void 0!==e._optId){var s=!0;"function"==typeof n.t[e._optId].obj.optionClick&&!0!==n.t[e._optId].obj.optionClick(e,t,n)&&(s=!1),s&&(n._setSelected(e._optId,null,!0),n._confirmSelect("click"))}e=e.parentNode}e=null}},this._doOnListMouseOut=function(t){n.conf.tm_hover&&window.clearTimeout(n.conf.tm_hover),n.conf.tm_hover=window.setTimeout(function(){var t=n.conf.last_match||n.conf.last_selected;null==n.conf.last_match&&null!=n.t[t]&&n.base.firstChild.value!=n.t[t].obj.getText(n.t[t].item,!0)&&(t=null),n._setSelected(t,null,!0,!0)},1)},this._doOnBaseMouseDown=function(t){if(n.conf.enabled&&(n.conf.clear_click=!0,(t=t||event).button==n.conf.btn_left)){var e=t.target||t.srcElement;if(e!=this.firstChild){window.setTimeout(function(){n.base.firstChild.focus()},1);for(var s=e;s!=this&&null!=s;)if(s==this.lastChild){if("function"==typeof n.modes[n.conf.opts_type].topImageClick){var i=n.conf.last_hover||n.conf.last_selected,o=null!=i?n.t[i].item:null;if(!0!==n.modes[n.conf.opts_type].topImageClick(o,n))return void(i=o=null)}s=null}else s=s.parentNode}n._isListVisible()?n._hideList():(e!=this.firstChild&&(n.conf.clear_blur=!0),n._showList(),n._setSelected(n.conf.last_selected,!0,!0)),e=null}},this._doOnBodyMouseDown=function(){n.conf.clear_click?n.conf.clear_click=!1:n._confirmSelect("blur")},this._doOnInputFocus=function(){n.conf.clear_blur=!1,n.conf.tm_confirm_blur&&window.clearTimeout(n.conf.tm_confirm_blur),0==n.conf.combo_focus&&(n.conf.combo_focus=!0,"material"==n.conf.skin&&null==n.base.className.match(/dhxcombo_actv/)&&(n.base.className+=" dhxcombo_actv"),n.callEvent("onFocus",[]))},this._doOnInputBlur=function(){1!=n.conf.clear_blur?(n.conf.tm_confirm_blur&&window.clearTimeout(n.conf.tm_confirm_blur),n.conf.tm_confirm_blur=window.setTimeout(function(){0==n.conf.clear_click&&(n._confirmSelect("blur"),n.conf.combo_focus=!1,"material"==n.conf.skin&&null!=n.base.className.match(/dhxcombo_actv/)&&(n.base.className=n.base.className.replace(/\s*dhxcombo_actv/gi,"")),n.callEvent("onBlur",[]))},20)):n.conf.clear_blur=!1},this._doOnInputKeyUp=function(t){if(t=t||event,0!=n.conf.f_mode)return n.conf.clear_bsp=8==t.keyCode||46==t.keyCode,void n._filterOpts();n._checkForMatch()},this._doOnInputKeyDown=function(t){38!=(t=t||event).keyCode&&40!=t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,n._keyOnUpDown(38==t.keyCode?-1:1)),113==t.keyCode&&(n._isListVisible()||(n._showList(),n.base.firstChild.value==n.conf.last_text?(n._setSelected(n.conf.last_selected,!0,!0),n.base.firstChild.value=n.conf.last_text,n.conf.f_server_last=n.base.firstChild.value.toLowerCase()):(n.conf.f_server_last=n.base.firstChild.value.toLowerCase(),0==n.conf.f_mode&&n._checkForMatch()))),27==t.keyCode&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,n._cancelSelect()),13==t.keyCode&&(t.preventDefault&&t.preventDefault(),n._confirmSelect("kbd")),1==n.conf.ro_mode&&(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=65&&t.keyCode<=90)&&(n._searchRO(String.fromCharCode(t.keyCode).toLowerCase()),t.cancelBubble=!0),n.conf.clear_key=!0,n.callEvent("onKeyPressed",[t.keyCode||t.charCode])},this._doOnInputKeyPress=function(t){n.conf.clear_key?n.conf.clear_key=!1:(t=t||event,n.callEvent("onKeyPressed",[t.keyCode||t.charCode]))},this._keyOnUpDown=function(t){var e=null;if(this.conf.last_hover?e=this.t[this.conf.last_hover].item:this.conf.last_selected&&(e=this.t[this.conf.last_selected].item),(e||0!=this._getListVisibleCount())&&(null!=e&&""!=e.style.display&&(e=null),this._showList(),null!=e?this.t[e._optId].obj.isSelected(e)&&(e=this._getNearItem(e,t)):""!=(e=this.list.firstChild).style.display&&(e=this._getNearItem(e,1)),null!=e)){if(this._setSelected(e._optId,!0,!0),0==this.conf.f_mode)this.base.firstChild.value=this.t[e._optId].obj.getText(e,!0);else{var s=String(this.t[e._optId].obj.getText(e,!0));"start"==this.conf.f_mode&&1==this.conf.f_ac?0===s.toLowerCase().indexOf(this.conf.f_server_last)?(this.conf.f_ac_text=s.substring(this.conf.f_server_last.length,s.length),this.base.firstChild.value=s,this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)):(this.base.firstChild.value=s,this.conf.f_server_last=this.base.firstChild.value.toLowerCase(),this._selectRange(0,this.base.firstChild.value.length)):(this.base.firstChild.value=s,this.conf.f_server_last=this.base.firstChild.value.toLowerCase())}e=null}},this.conf.evs_nodes=[{node:document.body,evs:{mousedown:"_doOnBodyMouseDown"}},{node:this.base,evs:{mousedown:"_doOnBaseMouseDown"}},{node:this.base.firstChild,evs:{keyup:"_doOnInputKeyUp",keydown:"_doOnInputKeyDown",keypress:"_doOnInputKeyPress",focus:"_doOnInputFocus",blur:"_doOnInputBlur"}},{node:this.list,evs:{mousemove:"_doOnListMouseMove",mousedown:"_doOnListMouseDown",mouseup:"_doOnListMouseUp",mouseout:"_doOnListMouseOut"}}];for(var c=0;c<this.conf.evs_nodes.length;c++)for(var d in this.conf.evs_nodes[c].evs)"function"==typeof window.addEventListener?this.conf.evs_nodes[c].node.addEventListener(d,this[this.conf.evs_nodes[c].evs[d]],!1):this.conf.evs_nodes[c].node.attachEvent("on"+d,this[this.conf.evs_nodes[c].evs[d]]);return this.unload=function(){this.clearAll(),this.t=null;for(var t=0;t<this.conf.evs_nodes.length;t++){for(var e in this.conf.evs_nodes[t].evs)"function"==typeof window.addEventListener?this.conf.evs_nodes[t].node.removeEventListener(e,this[this.conf.evs_nodes[t].evs[e]],!1):this.conf.evs_nodes[t].node.detachEvent("on"+e,this[this.conf.evs_nodes[t].evs[e]]),this.conf.evs_nodes[t].evs[e]=null,delete this.conf.evs_nodes[t].evs[e];this.conf.evs_nodes[t].node=null,this.conf.evs_nodes[t].evs=null,delete this.conf.evs_nodes[t].node,delete this.conf.evs_nodes[t].evs,this.conf.evs_nodes[t]=null}for(var e in window.dhx4._eventable(this,"clear"),window.dhx4._enableDataLoading(this,null,null,null,"clear"),this._mcDetachHeader(),this.DOMelem_input=this.DOMelem_button=this.DOMlist=this.DOMelem=this.DOMParent=null,this.conf)this.conf[e]=null,delete this.conf[e];for(var e in this.conf=null,"function"==typeof window.addEventListener?this.list.removeEventListener("scroll",this._doOnListScroll,!1):this.list.detachEvent("onscroll",this._doOnListScroll),this.base.parentNode.removeChild(this.base),this.list.parentNode.removeChild(this.list),this.base=this.list=this.cont=null,this.modes=null,this)"function"==typeof this[e]&&(this[e]=null);n=null},this.DOMelem_input=this.base.firstChild,this.DOMelem_button=this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)],this.DOMlist=this.list,this.DOMelem=this.base,this.DOMParent=t,t=null,null!=l&&(null!=l.filter&&("string"==typeof l.filter?this.enableFilteringMode(!0,l.filter,window.dhx4.s2b(l.filter_cache),window.dhx4.s2b(l.filter_sub_load)):this.enableFilteringMode(!0)),null!=l.image_path&&this.setImagePath(l.image_path),null==l.default_image&&null==l.default_image_dis||this.setDefaultImage(l.default_image,l.default_image_dis),(l.items||l.options)&&this.addOption(l.items||l.options),(l.xml||l.json)&&this.load(l.xml||l.json),void 0!==l.readonly&&this.readonly(l.readonly),l=null),this}function d5XComboFromSelect(t){"string"==typeof t&&(t=document.getElementById(t));var e=t.offsetWidth,s=t.getAttribute("name")||null,i=document.createElement("SPAN");t.parentNode.insertBefore(i,t);var o=new d5XCombo(i,s,e,t.getAttribute("mode")||t.getAttribute("opt_type")||"option");i=null;var n=t.getAttribute("imagePath");n&&o.setImagePath(n);var l=t.getAttribute("defaultImage"),h=t.getAttribute("defaultImageDis");1==window.dhx4.s2b(h)&&(h=!0),null==l&&null==h||o.setDefaultImage(l,h);var c=o._xmlToObj([t],!0,t.selectedIndex);return c.options.length>0&&o.addOption(c.options),c=null,t.parentNode.removeChild(t),t=null,o}function d5XComboExtend(t,e){for(var s in d5XCombo.prototype.modes[e])void 0===d5XCombo.prototype.modes[t][s]&&(d5XCombo.prototype.modes[t][s]=d5XCombo.prototype.modes[e][s])}d5XCombo.prototype.setName=function(t){this.conf.form_name=t,this.base.childNodes[1].name=t,this.base.childNodes[2].name=t.replace(/(\[.*)?$/,"_new_value$1")},d5XCombo.prototype.readonly=function(t){window.dhx4.s2b(t)?(this.base.firstChild.setAttribute("readOnly","true"),this.conf.ro_mode=!0):(this.base.firstChild.removeAttribute("readOnly"),this.conf.ro_mode=!1)},d5XCombo.prototype.setPlaceholder=function(t){void 0!==t&&null!=t||(t=""),this.base.firstChild.setAttribute("placeholder",String(t))},d5XCombo.prototype.setTemplate=function(t){for(var e in t)void 0!==this.conf.template[e]&&(this.conf.template[e]="header"==e?window.dhx4.s2b(t[e]):String(t[e]));for(var e in null!=t.columns?this._mcMakeTemplate(t.columns):this._mcDetachHeader(),this.t)this.t[e].obj.setText(this.t[e].item,this.t[e].item._conf.text);this._confirmSelect("template")},d5XCombo.prototype.setSkin=function(t){t!=this.conf.skin&&(this.conf.skin=t,this.base.className="dhxcombo_"+this.conf.skin+(this.conf.enabled?"":" dhxcombo_disabled"),this.list.className="dhxcombolist_"+this.conf.skin+(null!=this.hdr?" dhxcombolist_multicolumn":""),null!=this.hdr&&(this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr"),this.conf.i_ofs="material"==t?26:23,this._adjustBase())},d5XCombo.prototype.getInput=function(){return this.base.firstChild},d5XCombo.prototype.getButton=function(){return this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)]},d5XCombo.prototype.getList=function(){return this.list},d5XCombo.prototype.getBase=function(){return this.base},d5XCombo.prototype.getParent=function(){return this.DOMParent},d5XCombo.prototype.forEachOption=function(t){for(var e=0;e<this.list.childNodes.length;e++)t.apply(window,[this._getOption(this.list.childNodes[e]._optId,e)])},d5XCombo.prototype.setFocus=function(){this.conf.enabled&&this.base.firstChild.focus()},d5XCombo.prototype.setFontSize=function(t,e){null!=t&&(this.base.firstChild.style.fontSize=t),null!=e&&(this.list.style.fontSize=e)},d5XCombo.prototype.getOption=function(t){for(var e=null,s=null,i=0;i<this.list.childNodes.length;i++)if(null==e){var o=this.list.childNodes[i]._optId;this.t[o].obj.getValue(this.t[o].item)==t&&(e=o,s=i)}return null==e?null:this._getOption(e,s)},d5XCombo.prototype.getOptionByIndex=function(t){return t<0?null:null==this.list.childNodes[t]?null:this._getOption(this.list.childNodes[t]._optId,t)},d5XCombo.prototype.getOptionByLabel=function(t){for(var e=null,s=null,i=0;i<this.list.childNodes.length;i++)if(null==e){var o=this.list.childNodes[i]._optId;this.t[o].obj.getText(this.t[o].item,!0)==t&&(e=o,s=i)}return null==e?null:this._getOption(e,s)},d5XCombo.prototype.getSelectedIndex=function(){return this._getOptionProp(this.conf.last_selected,"index",-1)},d5XCombo.prototype.getSelectedText=function(){return this._getOptionProp(this.conf.last_selected,"text","")},d5XCombo.prototype.getSelectedValue=function(){return this._getOptionProp(this.conf.temp_selected||this.conf.last_selected,"value",null)},d5XCombo.prototype.getActualValue=function(){return this.base.childNodes[1].value},d5XCombo.prototype.getComboText=function(){return this.base.childNodes[0].value},d5XCombo.prototype.getIndexByValue=function(t){var e=this.getOption(t);return null!=e?e.index:-1},d5XCombo.prototype.setComboText=function(t){1==this.conf.allow_free_text&&(this.unSelectOption(),this.conf.last_text=this.base.firstChild.value=t,this.conf.f_server_last=this.base.firstChild.value.toLowerCase())},d5XCombo.prototype.setComboValue=function(t){var e=this.getOption(t);null!=e?this.selectOption(e.index):(this.conf.last_value=t,this.base.childNodes[1].value=this.conf.last_value,this.base.childNodes[2].value="true")},d5XCombo.prototype.selectOption=function(t,e,s){if(!(t<0||t>=this.list.childNodes.length)){var i=this.list.childNodes[t]._optId;this._setSelected(i,this._isListVisible(),!0),this._confirmSelect("script")}},d5XCombo.prototype.unSelectOption=function(){null!=this.conf.last_hover&&(this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,!1),this.conf.last_hover=null),this.base.firstChild.value="",0!=this.conf.f_mode&&this._filterOpts(!0),this._hideList(),this._updateTopImage(null),this._confirmSelect("script")},d5XCombo.prototype.confirmValue=function(){this._confirmSelect("script")},d5XCombo.prototype.enable=function(t){t=void 0===t||window.dhx4.s2b(t),this.conf.enabled!=t&&(this.conf.enabled=t,t?(this.base.className="dhxcombo_"+this.conf.skin,this.base.firstChild.removeAttribute("disabled")):(this._hideList(),this.base.className="dhxcombo_"+this.conf.skin+" dhxcombo_disabled",this.base.firstChild.setAttribute("disabled","true")),this._updateTopImage(this.conf.last_selected))},d5XCombo.prototype.disable=function(t){t=void 0===t||window.dhx4.s2b(t),this.enable(!t)},d5XCombo.prototype.isEnabled=function(){return 1==this.conf.enabled},d5XCombo.prototype.show=function(t){t=void 0===t||window.dhx4.s2b(t),this.base.style.display=1==t?"":"none"},d5XCombo.prototype.hide=function(t){void 0===t&&(t=!0),this.show(!t)},d5XCombo.prototype.isVisible=function(){return""==this.base.style.display},d5XCombo.prototype.setFilterHandler=function(t){"function"==typeof t?(this.conf.f_func=t,this.conf.f_mode=!0,this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null):"string"==typeof t&&"function"==typeof window[t]?(this.conf.f_func=window[t],this.conf.f_mode=!0,this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null):this.conf.f_func=null},d5XCombo.prototype.enableFilteringMode=function(t,e,s,i){1==t||"between"==t?(this.conf.f_mode=1==t?"start":"between",e?(this.conf.f_url=e,this.conf.f_cache=window.dhx4.s2b(s),this.conf.f_dyn=window.dhx4.s2b(i)):(this.conf.f_url=null,this.conf.f_cache=!1,this.conf.f_dyn=!1)):(this.conf.f_mode=!1,this.conf.f_url=null,this.conf.f_cache=!1,this.conf.f_dyn=!1)},d5XCombo.prototype.filter=function(t,e){for(var s=0;s<this.list.childNodes.length;s++){var i=t.apply(window,[this._getOption(this.list.childNodes[s]._optId,s)]);this.list.childNodes[s].style.display=!0===i?"":"none"}void 0!==e&&1!=e||this._showList(!0)},d5XCombo.prototype.sort=function(t){for(var e=[],s=0;s<this.list.childNodes.length;s++){var i=this.list.childNodes[s]._optId;e.push([i,this._getOption(i,s)])}for("asc"==t||"desc"==t?(k=!0,e.sort(function(e,s){e=e[1].text_option.toLowerCase(),s=s[1].text_option.toLowerCase();var i="asc"==t?1:-1;return e>s?i:-1*i})):"function"!=typeof t&&"function"!=typeof window[t]||("function"==typeof window[t]&&(t=window[t]),e.sort(function(e,s){return t.apply(window,[e[1],s[1]])}));this.list.childNodes.length>0;)this.list.removeChild(this.list.lastChild);for(s=0;s<e.length;s++)this.list.appendChild(this.t[e[s][0]].item)},d5XCombo.prototype.enableAutocomplete=function(t){t=void 0===t||window.dhx4.s2b(t),this.conf.f_ac=t},d5XCombo.prototype.disableAutocomplete=function(t){t=void 0===t||window.dhx4.s2b(t),this.enableAutocomplete(!t)},d5XCombo.prototype.allowFreeText=function(t,e){this.conf.allow_free_text=void 0===t||window.dhx4.s2b(t),this.conf.free_text_empty=void 0!==e&&window.dhx4.s2b(e)},d5XCombo.prototype._checkForMatch=function(t){for(var e=window.dhx4.trim(this.base.firstChild.value).toLowerCase(),s=null,i=this.list.firstChild;null!=i;){if(""==i.style.display&&null!=i._optId)e==window.dhx4.trim(this.t[i._optId].obj.getText(i,!0)).toLowerCase()&&(s=i._optId,i=null);null!=i&&(i=i.nextSibling)}null==this.conf.last_match?null!=s?(this._setSelected(s,!0,!0),this.conf.last_match=s):"between"==this.conf.f_mode&&1!=t||(this._setSelected(null,!0,!0),this.conf.last_match=null):null!=s?s!=this.conf.last_match&&(this._setSelected(s,!0,!0),this.conf.last_match=s):(this._setSelected(null,!0,!0),this.conf.last_match=null)},d5XCombo.prototype._selectRange=function(t,e){1==this.conf.combo_focus&&window.dhx4.selectTextRange(this.base.firstChild,t,e)},d5XCombo.prototype.openSelect=function(){this._isListVisible()||this._showList()},d5XCombo.prototype.closeAll=function(){this._hideList()},d5XCombo.prototype._showList=function(t){if(0!=this._getListVisibleCount())if(this._isListVisible())this._checkListHeight();else{this.list.style.zIndex=window.dhx4.zim.reserve(this.conf.list_zi_id),null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.zIndex=Number(this.list.style.zIndex)+1),this.list.style.visibility="hidden",this.list.style.display="",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.visibility=this.list.style.visibility,this.hdr.style.display=this.list.style.display);var e=null!=this.hdr&&1==this.conf.template.header?this.hdr.offsetHeight:0;this.list.style.width=Math.max(this.conf.opts_width||this.conf.col_w||0,this.conf.combo_width)+"px",this.list.style.top=window.dhx4.absTop(this.base)+e+this.base.offsetHeight-1+"px",this.list.style.left=window.dhx4.absLeft(this.base)+"px",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.width=this.list.style.width,this.hdr.style.left=this.list.style.left,this.hdr.style.top=parseInt(this.list.style.top)-e+"px"),this._checkListHeight(),this.list.style.visibility="visible",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.visibility="visible"),this.callEvent("onOpen",[])}else t&&this._isListVisible()&&this._hideList()},d5XCombo.prototype._hideList=function(){this._isListVisible()&&(window.dhx4.zim.clear(this.conf.list_zi_id),this.list.style.display="none",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.display="none"),this.conf.clear_click=!1,this.callEvent("onClose",[]))},d5XCombo.prototype._isListVisible=function(){return""==this.list.style.display},d5XCombo.prototype._getListVisibleCount=function(){for(var t=0,e=0;e<this.list.childNodes.length;e++)t+=""==this.list.childNodes[e].style.display?1:0;return t},d5XCombo.prototype._checkListHeight=function(){if(this._isListVisible()){if(null==this.conf.item_h){for(var t=this.list.firstChild;null!=t;)""==t.style.display?(this.conf.item_h=t.offsetHeight+(null!=this.hdr?-1:0),t=null):t=t.nextSibling;t=null}var e=window.dhx4.screenDim(),s=window.dhx4.absTop(this.base),i=this.base.offsetHeight,o=null!=this.hdr&&1==this.conf.template.header?this.hdr.offsetHeight:0,n=Math.max(0,Math.floor((s-o-e.top)/this.conf.item_h)),l=Math.max(0,Math.floor((e.bottom-(s+i+o))/this.conf.item_h)),h=this._getListVisibleCount();l<Math.min(this.conf.opts_count_min,h)&&n>l&&(l=null);var c=Math.min(null==l?n:l,this.conf.opts_count,h),d=c<h?c*this.conf.item_h+"px":"",a=this.conf.sp[this.conf.skin][null!=this.hdr&&1==this.conf.template.header?"hdr_ofs":"list_ofs"];this.list.style.height=d,this.list.style.top=(null==l?s-this.list.offsetHeight+a:s+i+o-a)+"px",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.top=(null==l?s-o-this.list.offsetHeight+a:s+i-a)+"px")}},d5XCombo.prototype._scrollToItem=function(t){var e=this.t[t].item.offsetTop,s=e+this.t[t].item.offsetHeight,i=this.list.scrollTop,o=i+this.list.clientHeight;e<i?this.list.scrollTop=e+(null!=this.hdr&&1==this.conf.template.header?1:0):s>o&&(this.list.scrollTop=s-this.list.clientHeight+(null!=this.hdr&&1==this.conf.template.header?-this.conf.sp[this.conf.skin].scr_ofs:0))},d5XCombo.prototype._setSelected=function(t,e,s,i){this.conf.temp_selected=null,s&&this._updateTopImage(t),null==t||this.conf.last_hover!=t?(null!=this.conf.last_hover&&(this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,!1),this.conf.last_hover=null,null==t&&this.callEvent("onSelectionChange",[])),null!=t&&(this.t[t].obj.setSelected(this.t[t].item,!0),this.conf.last_hover=t,1!=i&&(this.conf.temp_selected=t,this.callEvent("onSelectionChange",[])),"select"==this.conf.s_mode&&this.t[t].item==this.t[t].item.parentNode.lastChild&&this._subloadRequest(),e&&this._scrollToItem(t))):e&&this._scrollToItem(t)},d5XCombo.prototype._subloadRequest=function(){if(null!=this.conf.f_url&&1==this.conf.f_dyn&&0==this.conf.f_dyn_end){var t="mask="+encodeURIComponent(this.conf.f_mask)+"&pos="+this.list.childNodes.length,e=this,s=function(t){e.conf.f_cache&&e.conf.f_cache_data[e.conf.f_mask].data.push(t.xmlDoc.responseXML);var i=e.list.childNodes.length;e.conf.f_loading=!0,e.load(t.xmlDoc.responseXML),e.conf.f_loading=!1,i==e.list.childNodes.length&&(e.conf.f_dyn_end=!0,e.conf.f_cache&&(e.conf.f_cache_data[e.conf.f_mask].dyn_end=!0)),s=e=null};"post"==window.dhx4.ajax.method?window.dhx4.ajax.post(this.conf.f_url,t,s):"get"==window.dhx4.ajax.method&&window.dhx4.ajax.get(this.conf.f_url+(String(this.conf.f_url).indexOf("?")>=0?"&":"?")+t,s)}},d5XCombo.prototype.addOption=function(t,e,s,i,o){var n=null;if(t instanceof Array){for(var l=0;l<t.length;l++)if(void 0!==t[l])if(t[l]instanceof Array)h=this._renderOption({value:t[l][0],text:t[l][1],css:t[l][2],img:t[l][3]}),null==n&&1==window.dhx4.s2b(t[l][4])&&(n=h);else{h=this._renderOption(t[l]);null==n&&1==window.dhx4.s2b(t[l].selected)&&(n=h)}}else{var h=this._renderOption({value:t,text:e,css:s,img:i});null==n&&1==window.dhx4.s2b(o)&&(n=h)}null!=n&&(this._setSelected(n,this._isListVisible(),!0),this._confirmSelect("onInit"))},d5XCombo.prototype.updateOption=function(t,e,s,i){var o=this._getOptionId(t);null!=o&&(this.t[o].obj.update(this.t[o].item,{value:e,text:s,css:i}),this.conf.last_selected==o&&(this.conf.last_text=this.base.firstChild.value=this.t[o].obj.getText(this.t[o].item,!0),this.conf.f_server_last=this.base.firstChild.value.toLowerCase()))},d5XCombo.prototype.deleteOption=function(t){for(var e in this.t){this.t[e].obj.getValue(this.t[e].item)==t&&this._removeOption(e)}this._isListVisible()&&this._showList(!0)},d5XCombo.prototype.clearAll=function(t){for(var e in t=void 0===t||window.dhx4.s2b(t),this.t)this._removeOption(e);this.conf.tm_hover&&window.clearTimeout(this.conf.tm_hover),this.conf.last_hover=null,this.conf.last_selected=null,this.list.scrollTop=0,1==t&&this._hideList()},d5XCombo.prototype._renderOption=function(t){var e=window.dhx4.newId(),s=document.createElement("DIV");s._optId=e,s._tpl=this.conf.template,void 0===t.img&&void 0!==t.img_src&&(t.img=t.img_src,delete t.img_src),void 0===t.img_dis&&void 0!==t.img_src_dis&&(t.img_dis=t.img_src_dis,delete t.img_src_dis),t.img_path=this.conf.img_path,t.img_def=this.conf.img_def,t.img_def_dis=this.conf.img_def_dis,this.list.appendChild(s);var i=this._isListVisible()&&1==window.dhx4.isFF;if(1==i){this.list.scrollTop;this.list.scrollTop-=1}return null!=this.hdr&&(t.multicol=!0),this.t[s._optId]={obj:this.modes[this.conf.opts_type].render(s,t),item:s,conf:{type:this.conf.opts_type}},s=null,1==i&&(this.list.scrollTop+=1),e},d5XCombo.prototype._removeOption=function(t){this.t[t].obj.destruct(this.t[t].item),this.t[t].obj=null,this.t[t].item.parentNode.removeChild(this.t[t].item),this.t[t].item=null,this.t[t].conf=null,this.t[t]=null,delete this.t[t],this.conf.last_hover==t&&(this.conf.last_hover=null),this.conf.last_selected==t&&(this.conf.last_selected=null,this._confirmSelect("onDelete"))},d5XCombo.prototype._confirmSelect=function(t,e){var s=!1;if(void 0===e&&(e=!0),this.conf.f_server_tm&&window.clearTimeout(this.conf.f_server_tm),null!=this.conf.last_hover)s=s||this.conf.last_value!=this._getOptionValue(this.conf.last_hover),this.conf.last_match=this.conf.last_selected=this.conf.last_hover,this.conf.last_value=this._getOptionValue(this.conf.last_selected),this.conf.last_text=this.base.firstChild.value=this.t[this.conf.last_selected].obj.getText(this.t[this.conf.last_selected].item,!0),this.conf.f_server_last=this.base.firstChild.value.toLowerCase(),this.base.childNodes[1].value=this.conf.last_value,this.base.childNodes[2].value="false";else if(this.conf.allow_free_text||""==this.base.firstChild.value&&this.conf.allow_empty_value)s=s||this.conf.last_text!=this.base.firstChild.value,this.conf.last_match=this.conf.last_value=this.conf.last_selected=null,this.conf.last_text=this.base.firstChild.value,this.conf.f_server_last=this.base.firstChild.value.toLowerCase(),this.base.childNodes[1].value=this.conf.last_text,this.base.childNodes[2].value="true";else if("template"!=t)return this._cancelSelect(!0),void this._updateTopImage(this.conf.last_selected);this.conf.f_ac&&"start"==this.conf.f_mode&&(this.conf.f_ac_text="","blur"!=t&&this._selectRange(this.base.firstChild.value.length,this.base.firstChild.value.length)),e&&this._hideList(),1==s&&"onInit"!=t&&"onDelete"!=t&&(this.callEvent("onSelectionChange",[]),this.callEvent("onChange",[this.conf.last_value,this.conf.last_text]))},d5XCombo.prototype._cancelSelect=function(t){this._hideList(),1==t&&0==this.conf.allow_free_text&&1==this.conf.free_text_empty?(this.conf.f_server_last=this.conf.last_match=this.conf.last_value=this.conf.last_selected=null,this.base.childNodes[1].value=this.conf.last_text=this.base.firstChild.value="",this.base.childNodes[2].value="false"):this.base.firstChild.value=this.conf.last_text,0!=this.conf.f_mode&&this._filterOpts(!0)},d5XCombo.prototype._getOption=function(t,e){if(!this.t[t])return null;if(void 0===e&&(e=-1),e<0)for(var s=0;s<this.list.childNodes.length;s++)e<0&&this.list.childNodes[s]._optId==t&&(e=s);var i={value:this.t[t].obj.getValue(this.t[t].item),text:this.t[t].obj.getText(this.t[t].item),text_input:this.t[t].obj.getText(this.t[t].item,!0),text_option:this.t[t].obj.getText(this.t[t].item,null,!0),css:this.t[t].obj.getCss(this.t[t].item),selected:t==this.conf.last_selected,index:e};if("function"==typeof this.t[t].obj.getExtraData){var o=this.t[t].obj.getExtraData(this.t[t].item);for(var n in o)void 0===i[n]&&(i[n]=o[n])}return i},d5XCombo.prototype._getOptionProp=function(t,e,s){if(null!=t){var i=this._getOption(t);if(null!=i)return i[e]}return s},d5XCombo.prototype._getOptionId=function(t){for(var e=null,s=0;s<this.list.childNodes.length;s++)if(null==e){var i=this.list.childNodes[s]._optId;t==this.t[i].obj.getValue(this.t[i].item)&&(e=i)}return e},d5XCombo.prototype._getOptionValue=function(t){return this._getOptionProp(t,"value",null)},d5XCombo.prototype.setSize=function(t){this.conf.combo_width=parseInt(t)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0),this.base.style.width=Math.max(0,this.conf.combo_width)+"px",this._adjustBase(),this._isListVisible()&&(this._hideList(),this._showList())},d5XCombo.prototype._adjustBase=function(){this.base.firstChild.style.width=Math.max(0,this.conf.combo_width-(this.conf.i_ofs+1)-(this.conf.combo_image?this.conf.i_ofs:0))+"px",this.base.firstChild.style.marginLeft=this.conf.combo_image?this.conf.i_ofs+"px":"0px"},d5XCombo.prototype.setOptionWidth=function(t){this.conf.opts_width=parseInt(t)||null},d5XCombo.prototype.setOptionIndex=function(t,e){if(!(isNaN(e)||e<0)){var s=this.getOption(t);if(null!=s&&e!=s.index){var i=this.list.childNodes[s.index];i.parentNode.removeChild(i),null!=this.list.childNodes[e]?this.list.insertBefore(i,this.list.childNodes[e]):this.list.appendChild(i),i=null}}},d5XCombo.prototype.getOptionsCount=function(){return this.list.childNodes.length},d5XCombo.prototype._mcMakeTemplate=function(t){var e="",s="";this.conf.col_w=0;for(var i=0;i<t.length;i++){var o=Number(parseInt(t[i].width)||50),n=t[i].css||"",l=0==i&&1==window.dhx4.isIE6?"_first":"";s+="<div class='dhxcombo_cell"+l+" "+n+"' style='width:"+o+"px;'><div class='dhxcombo_cell_text'>"+(t[i].option||"&nbsp;")+"</div></div>",e+="<div class='dhxcombo_hdrcell"+l+" "+n+"' style='width:"+o+"px;'><div class='dhxcombo_hdrcell_text'>"+(t[i].header||"&nbsp;")+"</div></div>",this.conf.col_w+=o+1}o=500;var h=document.createElement("DIV");h.style.position="absolute",h.style.top="10px",h.style.left=2*-o+"px",h.style.width=o+"px",h.style.height="50px",h.style.overflowY="scroll",h.innerHTML="<div>&nbsp;</div>",document.body.appendChild(h),this.conf.col_w+=o-h.firstChild.offsetWidth+10,h.parentNode.removeChild(h),h=null,this.conf.template.option=s,this._mcAttachHeader(e),this.list.className+=" dhxcombolist_multicolumn"},d5XCombo.prototype._mcAttachHeader=function(t){null==this.hdr&&(this.hdr=document.createElement("DIV"),this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr",this.hdr.style.display="none",this.list.parentNode.insertBefore(this.hdr,this.list),"function"==typeof window.addEventListener?this.hdr.addEventListener("mousedown",this._doOnListMouseDown,!1):this.hdr.attachEvent("onmousedown",this._doOnListMouseDown),"checkbox"==this.conf.opts_type&&1==this.conf.combo_image&&(this.conf.combo_image=!1,null!=this.base.lastChild.className.match(/dhxcombo_top_image/)&&this.base.removeChild(this.base.lastChild),this._adjustBase())),this.hdr.innerHTML="<div class='dhxcombo_hdrtext'>"+t+"</div>"},d5XCombo.prototype._mcDetachHeader=function(){null!=this.hdr&&("function"==typeof window.addEventListener?this.hdr.removeEventListener("mousedown",this._doOnListMouseDown,!1):this.hdr.detachEvent("onmousedown",this._doOnListMouseDown),this.hdr.parentNode.removeChild(this.hdr),this.hdr=null),this.conf.col_w=null,this.conf.item_h=null},d5XCombo.prototype.modes={},d5XCombo.prototype.doWithItem=function(t,e,s,i){var o=t>=0&&t<this.list.childNodes.length?this.list.childNodes[t]._optId:null;if(null==o)return null;if("function"!=typeof this.t[o].obj[e])return null;for(var n=[this.t[o].item],l=2;l<arguments.length;l++)n.push(arguments[l]);return this.t[o].obj[e].apply(this.t[o].obj,n)},d5XCombo.prototype.modes.option={image:!1,html:!1,option_css:"dhxcombo_option_text",render:function(t,e){return t._conf={value:e.value,css:""},t.className="dhxcombo_option",t.innerHTML="<div class='"+this.option_css+"'>&nbsp;</div>",null!=e.css&&(t.lastChild.style.cssText=e.css,t._conf.css=e.css),this.setText(t,e.text),this},destruct:function(t){t._conf=null},update:function(t,e){t._conf.value=e.value,t._conf.css=e.css,t.lastChild.style.cssText=e.css,this.setText(t,e.text)},setText:function(t,e,s){t._conf.text=e;var i="object"==typeof e?window.dhx4.template(t._tpl.option,this.replaceHtml(t._conf.text,s),!0):window.dhx4.trim(this.replaceHtml(t._conf.text,s)||"");t.lastChild.innerHTML=0==i.length?"&nbsp;":i},getText:function(t,e,s){return window.dhx4.s2b(e)&&"object"==typeof t._conf.text?window.dhx4.template(t._tpl.input,t._conf.text,!0):window.dhx4.s2b(s)&&"object"==typeof t._conf.text?window.dhx4.template(t._tpl.option,t._conf.text,!0):t._conf.text},getValue:function(t){return t._conf.value},getCss:function(t){return t._conf.css},setSelected:function(t,e){t.className="dhxcombo_option"+(e?" dhxcombo_option_selected":"")},isSelected:function(t){return String(t.className).indexOf("dhxcombo_option_selected")>=0},getExtraData:function(t){return{type:"option"}},replaceHtml:function(t,e){if(1==this.html)return t;if(void 0!==e&&null!=e||(e={}),"object"==typeof t){var s={};for(var i in t)s[i]=1==e[i]?t[i]:this.replaceHtml(t[i])}else s=(t||"").replace(/[\<\>\&\s]/g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case" ":return"&nbsp;"}return t});return s}},d5XCombo.prototype.modes.checkbox={image:!0,html:!1,image_css:"dhxcombo_checkbox dhxcombo_chbx_#state#",option_css:"dhxcombo_option_text dhxcombo_option_text_chbx",render:function(t,e){null==this.image_css_regexp&&(this.image_css_regexp=new RegExp(this.image_css.replace("#state#","\\d*"))),t._conf={value:e.value,css:"",checked:window.dhx4.s2b(e.checked)},t.className="dhxcombo_option";var s={};return 1==e.multicol?(e.text.checkbox="<div class='"+String(this.image_css).replace("#state#",t._conf.checked?"1":"0")+"'></div>&nbsp;",s.checkbox=!0,t.innerHTML="<div class='"+d5XCombo.prototype.modes.option.option_css+"'></div>"):t.innerHTML="<div class='"+String(this.image_css).replace("#state#",t._conf.checked?"1":"0")+"'></div><div class='"+this.option_css+"'>&nbsp;</div>",null!=e.css&&(t.lastChild.style.cssText+=e.css,t._conf.css=e.css),this.setText(t,e.text,s),this},setChecked:function(t,e){t._conf.checked=window.dhx4.s2b(e);var s=String(this.image_css).replace("#state#",t._conf.checked?"1":"0");this._changeChbxCss(t.childNodes,s)},_changeChbxCss:function(t,e){for(var s=0;s<t.length;s++)null!=t[s].tagName&&null!=t[s].className&&null!=t[s].className.match(this.image_css_regexp)?t[s].className=e:t[s].childNodes.length>0&&this._changeChbxCss(t[s].childNodes,e)},isChecked:function(t){return 1==t._conf.checked},getExtraData:function(t){return{type:"checkbox",checked:t._conf.checked}},optionClick:function(t,e,s){for(var i=!0,o=e.target||e.srcElement;1==i&&null!=o&&o!=t&&null!=o.className;)if(null!=o.className.match(this.image_css_regexp)){var n=[t._conf.value,!t._conf.checked];!0===s.callEvent("onBeforeCheck",n)&&(this.setChecked(t,!this.isChecked(t)),s.callEvent("onCheck",n)),i=!1,n=null}else o=o.parentNode;return o=s=t=null,i},getTopImage:function(t,e){return""},topImageClick:function(t,e){return!0}},d5XComboExtend("checkbox","option"),d5XCombo.prototype.setChecked=function(t,e){this.doWithItem(t,"setChecked",e)},d5XCombo.prototype.getChecked=function(t){for(var e=[],s=0;s<this.list.childNodes.length;s++)this.isChecked(s)&&e.push(this._getOptionProp(this.list.childNodes[s]._optId,"value",""));return e},d5XCombo.prototype.isChecked=function(t){return this.doWithItem(t,"isChecked")},d5XCombo.prototype.modes.image={image:!0,html:!1,image_css:"dhxcombo_image",option_css:"dhxcombo_option_text dhxcombo_option_text_image",render:function(t,e){return t._conf={value:e.value,css:""},t.className="dhxcombo_option",t.innerHTML="<div class='"+this.image_css+"'></div><div class='"+this.option_css+"'>&nbsp;</div>",null!=e.css&&(t.lastChild.style.cssText+=e.css,t._conf.css=e.css),this.setText(t,e.text),this.setImage(t,e.img,e.img_dis,e.img_path,e.img_def,e.img_def_dis),this},update:function(t,e){t._conf.value=e.value,t._conf.css=e.css,t.lastChild.style.cssText=e.css,this.setText(t,e.text),this.setImage(t,e.img,e.img_dis,e.img_path,e.img_def,e.img_def_dis)},setImage:function(t,e,s,i,o,n){e=null!=e&&e.length>0?i+e:null!=o&&o.length>0?i+o:null,s=null!=s&&s.length>0?i+s:null!=n&&n.length>0?i+n:1==n?e:null,t._conf.img=e,t._conf.img_dis=s,t.firstChild.style.backgroundImage=null!=e?"url("+e+")":"none"},getExtraData:function(t){return{type:"image"}},getTopImage:function(t,e){var s=e?"img":"img_dis";return null!=t&&null!=t._conf[s]?"<div class='"+this.image_css+"' style='background-image:url("+t._conf[s]+");'></div>":""}},d5XComboExtend("image","option"),d5XCombo.prototype.setDefaultImage=function(t,e){null!=t&&(this.conf.img_def=t),null!=e&&(this.conf.img_def_dis=e)},d5XCombo.prototype.setImagePath=function(t){this.conf.img_path=t};
